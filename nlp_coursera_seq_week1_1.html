<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>자연어 처리 기본 - 콜세라 강의 1주차 1리뷰</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="딥러닝과 NLP 논문 공부, 구현 블로그" />
    <link rel="shortcut icon" href="https://dhsimpson.github.io/assets/built/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="https://dhsimpson.github.io/nlp_coursera_seq_week1_1" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="DL&NLP" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="자연어 처리 기본 - 콜세라 강의 1주차 1리뷰" />
    <meta property="og:description" content="배경 지식이 있는 상태에서 수업을 들으면 더 잘 이해가 되지 않을까 싶어 요약본을 만들어 봤습니다. 강의 특징에 따라 ‘ 이 강의에선 무엇을 배웁니다’ 만 설명할 수도, 혹은 해당 강의 내용 일부분/전체를 설명할 수도 있습니다. 회원가입만 하면 coursera의 deeplearning.ai 관련 강의 영상을 전부 무료로 볼 수 있습니다. (하지만 유료 구독을 하고" />
    <meta property="og:url" content="https://dhsimpson.github.io/nlp_coursera_seq_week1_1" />
    <meta property="og:image" content="https://dhsimpson.github.io/assets/built/images/background_nlp_basics.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="1863-11-28T00:10:00+09:00" />
    <meta property="article:modified_time" content="1863-11-28T00:10:00+09:00" />
    <meta property="article:tag" content="Nlpbasics" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="자연어 처리 기본 - 콜세라 강의 1주차 1리뷰" />
    <meta name="twitter:description" content="배경 지식이 있는 상태에서 수업을 들으면 더 잘 이해가 되지 않을까 싶어 요약본을 만들어 봤습니다. 강의 특징에 따라 ‘ 이 강의에선 무엇을 배웁니다’ 만 설명할 수도, 혹은 해당 강의 내용 일부분/전체를 설명할 수도 있습니다. 회원가입만 하면 coursera의 deeplearning.ai 관련 강의 영상을 전부 무료로 볼 수 있습니다. (하지만 유료 구독을 하고" />
    <meta name="twitter:url" content="https://dhsimpson.github.io/" />
    <meta name="twitter:image" content="https://dhsimpson.github.io/assets/built/images/background_nlp_basics.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="DL&NLP" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Nlpbasics" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "DL&NLP",
        "logo": "https://dhsimpson.github.io/"
    },
    "url": "https://dhsimpson.github.io/nlp_coursera_seq_week1_1",
    "image": {
        "@type": "ImageObject",
        "url": "https://dhsimpson.github.io/assets/built/images/background_nlp_basics.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://dhsimpson.github.io/nlp_coursera_seq_week1_1"
    },
    "description": "배경 지식이 있는 상태에서 수업을 들으면 더 잘 이해가 되지 않을까 싶어 요약본을 만들어 봤습니다. 강의 특징에 따라 ‘ 이 강의에선 무엇을 배웁니다’ 만 설명할 수도, 혹은 해당 강의 내용 일부분/전체를 설명할 수도 있습니다. 회원가입만 하면 coursera의 deeplearning.ai 관련 강의 영상을 전부 무료로 볼 수 있습니다. (하지만 유료 구독을 하고"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="자연어 처리 기본 - 콜세라 강의 1주차 1리뷰" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://dhsimpson.github.io/">DL&NLP</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-nlp_basics" role="menuitem"><a href="/tag/NlpBasics/">자연어 처리</a></li>
    <li class="nav-paper_review" role="menuitem"><a href="/tag/PaperReview/">논문 리뷰</a></li>
    <li class="nav-paper_implement" role="menuitem"><a href="/tag/PaperImplement/">논문 구현</a></li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">Tag별 Posts</a>
    </li>
</ul>
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-nlpbasics post tag-python ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="28 November 1863">28 November 1863</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/nlpbasics/'>NLPBASICS</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">자연어 처리 기본 - 콜세라 강의 1주차 1리뷰</h1>
            </header>

            <!-- 
            <figure class="post-full-image" style="background-image: url(/assets/built/images/background_nlp_basics.jpg)">
            </figure>
             -->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h2 id="배경-지식이-있는-상태에서-수업을-들으면-더-잘-이해가-되지-않을까-싶어-요약본을-만들어-봤습니다">배경 지식이 있는 상태에서 수업을 들으면 더 잘 이해가 되지 않을까 싶어 요약본을 만들어 봤습니다.</h2>

<h2 id="강의-특징에-따라--이-강의에선-무엇을-배웁니다-만-설명할-수도-혹은-해당-강의-내용-일부분전체를-설명할-수도-있습니다">강의 특징에 따라 ‘ 이 강의에선 무엇을 배웁니다’ 만 설명할 수도, 혹은 해당 강의 내용 일부분/전체를 설명할 수도 있습니다.</h2>

<p>회원가입만 하면 coursera의 deeplearning.ai 관련 강의 영상을 전부 무료로 볼 수 있습니다.   <br />
(하지만 유료 구독을 하고 매 주 코딩 과제를 하시길 추천 드립니다.)     <br />
강의 주소 : <a href="https://www.coursera.org/learn/nlp-sequence-models">링크</a></p>

<h1 id="1why-sequence-models시퀀스-모델을-사용하는-이유">1.Why sequence models(시퀀스 모델을 사용하는 이유)</h1>
<p>이번 강의에선 시퀀스(텍스트나 음향 데이터와 같이 한 데이터가 (시간)순서대로 나열된 경우) 시퀀스 모델을 사용하는 이유를 설명합니다.</p>
<details>
  <summary>자세히/간단히</summary>
  <p>시퀀스 모델의 파라미터(W,b 값들)는 다른 모델 구조와는 다르게 시간 순서에 따른 정보까지 가집니다.      <br />
시퀀스 모델은 입력 or 출력 데이터가 ‘순서’ 를 가질 경우에 유용합니다.     <br />
ex) 음성 데이터(파동의 순서), 텍스트 데이터(문장 구성 토큰의 순서), 동영상 데이터(이미지의 순서), DNA 염기서열(아미노산 순서) 등등..</p>
</details>

<h1 id="2notation시퀀스-모델-강의에서-사용할-용어-정리">2.Notation(시퀀스 모델 강의에서 사용할 용어 정리)</h1>
<p>이번 강의에선 시퀀스 모델 강의에서 사용할 용어(Notation)를 설명합니다.    <br />
x<sup> &lt;t&gt; </sup>    <br />
x<sup>(i) &lt;t&gt; </sup>    <br />
T<sub>x</sub>     <br />
T<sup>(i)</sup><sub>x</sub>   <br />
정도가 있습니다.</p>
<details>
  <summary>자세히/간단히</summary>
  <p>입력 시퀀스 x 가 9 단어로 이뤄진 문장 ‘Harry Potter and Hermione Granger invented a new spell’ 일 때,</p>

  <p>x<sup> &lt;t&gt; </sup> 는 입력 시퀀스 데이터의 t 번 째 요소입니다. (t는 time step)
x<sup>(i) &lt;t&gt; </sup> 는 m개 데이터 중 i번 째 입력 시퀀스 데이터의 t 번 째 요소입니다. (t는 time step)     <br />
T<sub>x</sub> = 9 는 입력 시퀀스 데이터의 요소 수(time step 수)는 9 라는 뜻입니다.     <br />
T<sup>(i)</sup><sub>x</sub> = 9 는 m개 데이터 중 i번 째 입력 시퀀스 데이터의 요소 수(time step 수)는 9 라는 뜻입니다.</p>

  <p>c.f.) Y(출력값 혹은 라벨값) 이 시퀀스 데이터일 경우에도 마찬가지로 사용합니다. (위 notation에서 x만 y로 바꾸면 되겠죠.)</p>

  <p>텍스트 데이터를 다룰 땐 아래 그림과 같이 사전(vocabulary)을 만들어 이용합니다.(이 경우는 단어 단위 사전)       <br />
사전에 들어 갈 요소는 ‘음소’ , ‘어절’, ‘음절’ 등 여러 종류의 단위가 가능하며, 이를 토큰 이라고 합니다.    <br />
(왠만하면 앞으로는 토큰 이라고 얘기 하겠습니다.)    <br />
<img src="assets/built/images/coursera_week1/coursera_week1_2_vocabulary.png" alt="" />
텍스트 데이터는 시퀀스 데이터 중 하나입니다.</p>

  <p>텍스트는 string 값이지만 컴퓨터는 string 보단 숫자를 더 잘 이해할 수 있기 때문에 숫자로 치환해 줍니다.</p>

  <p>자연어 처리에서 string -&gt; 숫자 로 바꿀 때, ‘벡터’ 로 표현하며, ‘one-hot 벡터 인코딩 방법’ 과 ‘단어 embedding 방법’을 사용합니다.</p>

  <p>one-hot 벡터 인코딩은 하나의 요소만 1이고 나머지는 0인 벡터로 인코딩(or 치환) 하는 방법 입니다.</p>

  <p>위 그림에서, vocabulary의 1번째 토큰은 “a” 이며, 1번째 토큰을 one-hot 인코딩 하면     <br />
[1 0 0 ….. 0] 이 됩니다.(1 번째 원소만 1값)</p>

  <p>벡터의 크기는 사전의 크기와 동일합니다.(vocabulary 가 100개 토큰으로 이뤄져 있다면 벡터 크기는 1x100)   <br />
(c.f. 벡터 index 시작은 0이지만 위 설명에서만 1이라고 생각합시다 ㅎㅎ)</p>

  <p>그렇다면 vocabulary의 i 번째 토큰을 one-hot 인코딩 하면   <br />
[0 . . … 1 . . …. 0] 인 i 번째 요소만 1인 벡터가 됩니다.</p>

  <p>( c.f. vocabulary에 없는 토큰은 vocabulary에 “unk”(==unknown) 이라는 토큰을 추가해 줌으로써 해결합니다.   <br />
vocabulary에 없는 토큰은 전부 “unk” 토큰으로 처리하는 거죠.   <br />
이러한 토큰을 NLP 영역(domain)에선 “스페셜 토큰” 이라고 하며,     <br />
UNK(Unknwon), SEP(seperateor), PAD(padding), SOS(Start of Sentence), EOS(End of Sentence) 등이 있습니다.  )</p>

</details>

<h1 id="3recurrent-neural-network-modelrnn-순환-신경망-모델">3.Recurrent Neural Network Model(RNN, 순환 신경망 모델)</h1>
<p>이 강의에선 순서가 있는 데이터를 처리할 때 standard network 사용의 단점과, 이를 개선한 RNN을 소개합니다.</p>
<details>
  <summary>자세히/간단히</summary>
  <p>(아래 그림을 봐주세요)
RNN 모델은 Cell 로 이뤄져 있습니다. 아래 그림에서 좌/우의 RNN 모델은 같은 모델이며 Cell 하나로 이뤄진 모델입니다.     <br />
Cell은 이전 time step의 활성화 값(activation a<sup>&lt;t-1&gt;</sup>)과 현재 time step의 입력 데이터 x<sup>&lt;t&gt;</sup>    <br />
를 입력받아 파라미터(Waa, Wax, Wya)값과 연산해 다음 활성화 값 a<sup>&lt;t&gt;</sup> 과 현재 time step의 출력값 y^<sup>&lt;t&gt;</sup>      <br />
를 출력합니다.</p>

  <p>아래 그림의 경우에선 T<sub>x</sub> 번의 연산 동안 동일한 가중치 Waa, Wax, Wya으로 T<sub>x</sub> 개의 출력값(y^), 활성화 값(a) 를 계산할 것입니다.</p>

  <p>Waa, Wax, Wya는 하나 씩 있지만 back propagation 을 위한 cache는 종류 별로 T<sub>x</sub> 개 만큼 생기겠죠?
<img src="assets/built/images/coursera_week1/coursera_week1_3_rnn.png" alt="" /></p>

  <p>(아래 그림을 봐주세요)    <br />
time step t 에선 a<sup>&lt;t-1&gt;</sup>와 Waa, x<sup>&lt;t&gt;</sup>와 Wax 의 곱을 각각 해서 현재 time step 활성화 값 a<sup>&lt;t&gt;</sup>를 구합니다.      <br />
또한, 두 연산은 Waa, Wax를 연결(concatenate)하고 a<sup>&lt;t-1&gt;</sup>와 x<sup>&lt;t&gt;</sup>를 연결한 행렬을 곱함으로써 연산 횟수를 줄일 수가 있죠.        <br />
<img src="assets/built/images/coursera_week1/coursera_week1_3_calculate.png" alt="" /></p>

</details>

<h1 id="4backpropagation-through-time">4.Backpropagation through time</h1>
<p>이번 강의에선 BPTT(Back Propagation Through Time) 에 대해 설명합니다.     <br />
RNN 모델의 역전파(Back Propagation)는 BPTT(Back Propagation Through Time) 이라는 방법을 이용합니다.   <br />
RNN 모델 Cell이 정방향 전파(Feed Forward)가 끝날 때까지 총 T 번의 time step 만큼 정방향 전파를 하므로, 역전파 역시 T time 만큼(Through ‘T’ Time) 하는 것이죠.</p>
<details>
  <summary>자세히/간단히</summary>
  <p>RNN 모델에선 Loss function을 아래와 같이 정의합니다.      <br />
모든 Time Step들의 Loss 값 평균을 RNN 모델의 Loss 값으로 하고,    <br />
역전파(Back Propagation)는 Time Step 만큼 이뤄집니다. (T번째의 Wya 가중치 변화량 구한 뒤 T번째 Wa 가중치 변화량을 구하고 해당 작업을 0 번째 Time Step까지 쭉쭉쭉…)      <br />
<img src="assets/built/images/coursera_week1/coursera_week1_4_BackProp.png" alt="" /></p>
</details>

<h1 id="5different-types-of-rnns">5.Different types of RNNs</h1>
<p>이번 강의에선 입력/출력 데이터의 특성에 따른 몇 종류의 RNN를 살펴봅니다.     <br />
사실 RNN 모델(RNN Cell) 자체는 전부 동일하지만 ‘입력/출력 데이터를 어떻게 input 하고 어떻게 output 하는지’ 에 대한 구조만 다릅니다.   <br />
‘Many-to-Many’, ‘Many-to-one’, ‘One-to-one’ 등등… 의 여러 구조가 있으며     <br />
to 앞은 Tx(입력 데이터 x의 time step), to 뒤는 Yt(출력 데이터 y의 time step) 이라 생각하심 됩니다.</p>
<details>
  <summary>자세히/간단히</summary>

  <ol>
    <li>‘one-to-one’
      <blockquote>
        <p><img src="assets/built/images/coursera_week1/coursera_week1_5_one_to_one.png" alt="" />
입력 데이터가 1개의 time step, 출력 데이터도 1개의 time step만 가집니다.</p>
      </blockquote>
    </li>
    <li>‘one-to-many’
      <blockquote>
        <p><img src="assets/built/images/coursera_week1/coursera_week1_5_one_to_many.png" alt="" />
입력 데이터는 1번째 time step에만 하나 들어가지만 출력 데이터는 T개의 time step만큼 나옵니다. (즉 T개의 출력 데이터 Y)</p>

        <p>또한, 화살표를 보면 알 수 있듯이 i 번째 출력 데이터가 i+1 번째 Time step의 입력 데이터로 이용됩니다.</p>

        <p>(즉 0번째 time step의 입력 데이터는 x이며, 이후 1~T 번째 입력 데이터는 이전 time step의 출력 데이터를 이용합니다.)</p>
      </blockquote>
    </li>
    <li>‘many-to-one’
      <blockquote>
        <p><img src="assets/built/images/coursera_week1/coursera_week1_5_many_to_one.png" alt="" />
‘one-to-many’와 반대로 입력 데이터가 T개의 time step을 가집니다.</p>

        <p>출력 데이터는 time step만큼 ‘존재 했었지만’, 마지막 time step의 출력 데이터 빼곤 버립니다.(마지막 출력 데이터만 원하므로).</p>
      </blockquote>
    </li>
    <li>‘many-to-many’ - type 1
      <blockquote>
        <p><img src="assets/built/images/coursera_week1/coursera_week1_5_many_to_many_1.png" alt="" />
입력 데이터는 Tx의 time step을 가지며, 출력 데이터 또한 동일한 수의 time step을 가집니다.</p>
      </blockquote>
    </li>
    <li>‘many-to-many’ - type 2(인코더-디코더)
      <blockquote>
        <p><img src="assets/built/images/coursera_week1/coursera_week1_5_many_to_many_2.png" alt="" />
입력 데이터가 있는 cell과 입력 데이터가 없는 cell이 있습니다.(2개의 RNN cell을 가지는 모델입니다.)</p>

        <p>각각을 인코더(Encoder) cell, 디코더(Decoder) cell 이라 부릅니다.</p>

        <p>처음 RNN을 배울 때, RNN cell은 0 번째 time step에선 활성화 벡터 a를 0벡터를 입력 활성화 벡터로 이용했었죠.</p>

        <p>인코더-디코더 구조에선</p>

        <p>인코더 RNN cell은 0벡터 활성화 벡터 a를 받고</p>

        <p>디코더 RNN cell은 인코더의 최종 활성화 벡터인 a<sub>Tx<sub> 를 입력 활성화 벡터로 받습니다.(이 때 a<sub>Tx<sub> 을 context vector 라고 부릅니다.)</sub></sub></sub></sub></p>
      </blockquote>
    </li>
  </ol>

</details>

<h1 id="6language-model-and-sequence-generation">6.Language model and sequence generation</h1>
<p>이번 강의에선 RNN을 이용한 언어 모델, (문장)시퀀스 생성 에 대해 수업합니다.    <br />
언어 모델이란 구글 문장 자동완성 기능처럼 주어진 문장 다음에 올 단어or문장을 예측하는 모델입니다.(아래 그림)     <br />
1주차 5강의 RNN 모델 중 Many-to-Many 혹은 One-to-Many 구조 둘 다 이용할 수 있고 둘을 섞을 수도 있습니다.      <br />
<img src="assets/built/images/coursera_week1/coursera_week1_6_LM.png" alt="" />
딥러닝을 사용하지 않고도 만들 수 있습니다!!(조건부 확률을 이용)</p>

<p>위에서 언급한 Many-to-Many, One-to-Many 모델을 둘 다 설명해 보겠습니다.   <br />
(더 이해하기 쉬우시도록 강의내용과 좀 다르게 설명합니다.)</p>

<p>c.f.) Andrew ng 교수님은 x<sup> &lt;1&gt; </sup> 토큰으로 0벡터를 input 하셨는데,      <br />
이건 아마 학습 데이터가 “Cats average…..” 하나만 있는 경우에, sequence generation model을 어떻게 학습 시키는지를 설명하고 싶으셨던 것 같습니다.    <br />
만약 학습 데이터가 여러개일 경우, 학습을 시키고 입력 데이터로 항상 0 벡터만 넣는다면 항상 동일한 문장을 예측/생성(generation) 하겠죠.</p>

<details>
  <summary>자세히/간단히</summary>

  <ol>
    <li>Many-to-Many 구조(Teacher Force, 교사 강요)
      <blockquote>
        <p>1주차 2강에서 말씀드린 스페셜 토큰 중, &lt;EOS&gt;(End Of Sentence) 라는 녀석이 있었죠?</p>

        <p>언어 모델을 학습시킬 때, 입력 데이터의 맨 마지막 토큰이 &lt;EOS&gt; 라면 문장 예측을 끝내도록 학습시킬 수 있습니다.</p>

        <p>Many-to-Many 구조는 Teacher Force(교사 강요) 학습 방법이라고도 할 수 있는데요.</p>

        <p>t+1 번째 입력 토큰으로 입력 데이터 x<sup> &lt;t+1&gt; </sup>만을 사용하는 방법이며,</p>

        <p>(실제 t번째의 예측값( y<sup> &lt;t+1&gt; </sup> )과 ‘같아야 할 토큰’을 입력으로 넣으므로 아래 그림에선 x<sup> &lt;t+1&gt; </sup> = y<sup> &lt;t+1&gt; </sup> 라고 적습니다.)</p>

        <p>(주의 - 그림에서 y^ 과 y 을 잘 구별해서 보셔야 합니다. y^은 feed forward 시의 출력값이었죠?!)</p>

        <p>t 번째 예측이 잘못됐어도 x<sup> &lt;t+1&gt; </sup>를 이용해 올바른 방향 학습시킬 수 있기에 ‘교사 강요’ 라고 불립니다.</p>

        <p>학습은 빠르게 될 지 몰라도 모델이 입력 데이터에 편향을 가질 우려가 있습니다.
<img src="assets/built/images/coursera_week1/coursera_week1_6_many_to_many.png" alt="" /></p>
      </blockquote>
    </li>
    <li>One-to-Many 구조
      <blockquote>
        <p>첫 번째 입력 토큰만(one) 넣으면 문장이 자동완성(to many!!) 되는 구조입니다.</p>

        <p>One-to-Many는 첫 번째 입력 토큰을 넣어서 나온 예측 데이터를(y^<sup> &lt;t&gt; </sup>) 다음 입력값으로 사용했었죠?</p>

        <p>여기서 발생하는 문제는, ‘언제 문장 생성을 종료하지?’ 입니다.</p>

        <p>해결 방법은 &lt;EOS&gt; 토큰입니다.</p>

        <p>만약 y^<sup> &lt;t&gt; </sup> 가 &lt;EOS&gt; 토큰이라면, t+1 번째 입력값으로 &lt;EOS&gt; 토큰이 들어가고, 문장 예측은 종료하게 되겠죠.</p>

        <p>(물론 &lt;EOS&gt; 나왔을 때 문장 예측 종료하도록 하는 것은 개발자의 몫이죠.)
<img src="assets/built/images/coursera_week1/coursera_week1_6_one_to_many.png" alt="" /></p>
      </blockquote>
    </li>
    <li>1,2를 섞어서
      <blockquote>
        <p>1번과 2번 방법을 섞어서 사용하면 둘 다의 장점을 가져갈 수가 있습니다. (학습도 빨리 되고 편향도 줄이고)</p>

        <p>예를 들면 홀수 번째 epoch은 1번 방법으로, 짝수 번째 epoch은 2번 방법으로 학습시키는 거죠!</p>
      </blockquote>
    </li>
  </ol>

</details>

<h1 id="7sampling-novel-sequences">7.Sampling novel sequences</h1>
<p>이 강의에선 1주차 6강에서 나온 Language Model을 이용해 문장 생성을 하는 방법에 대해 수업합니다.   <br />
학습시킨 모델을 이용해 문장을 생성할 땐 One-to-Many 구조로 예측 시킵니다.     <br />
c.f.) 자동완성의 경우엔 n개 단어를 입력해 뒤에 나올 문장을 자동완성 시킵니다.     <br />
(one-to-many라기 보단 n-to-many 이죠! n+1부턴 one-to-many 구조처럼 됩니다.)</p>

<p>추가로, 문자를 토큰 단위로 한 모델도 수업합니다.      <br />
단어를 토큰 단위로 하는 것 보다 vocabulary가 훠어어얼~~씬 작아진다는 장점이 있겠지만,     <br />
어떤 토큰 단위를 사용하건 간에 다 장단점이 있습니다.</p>

<h1 id="8vanishing-gradients-with-rnns">8.Vanishing gradients with RNNs</h1>
<p>이번 강의에선 RNN 모델의 vanishing gradients 문제점에 대해 설명합니다.</p>

<p>RNN 모델은 시퀀스 데이터 학습에 적합한 구조를 가집니다.</p>

<p>하지만 ‘긴 시퀀스’ 를 다루는 경우, 앞쪽(0 번째 time step에 가까운 쪽)의 정보가    <br />
뒷쪽(Tx 번째 time step에 가까운 쪽)의 정보에 ‘충분히’ 전달되지 않는 문제가 생깁니다.(앞쪽의 정보가 점점 희미해지는 것이죠.)</p>

<p>이 문제는 결국 Back Propagation 에 영향을 미쳐 ‘앞의 정보를 뒤에까지 충분히 전달해 줄 수 있는 모델’ 을 만들지 못하는 거지요.</p>

<p>다음 두 강의에선 해당 문제점을 해결하기 위한 모델을 설명하는데, 두 모델 다 RNN의 개조형태라고 생각하심 됩니다.</p>

<h1 id="9gated-recurrent-unit-gru">9.Gated Recurrent Unit (GRU)</h1>
<p>이 강의에선 GRU에 대해 설명합니다.    <br />
‘Gated’ 라는 뜻은 RNN Cell 내부에 ‘어떤’ 기능을 하는 ‘게이트’ 를 추가했다는 말입니다.</p>

<details>
  <summary>자세히/간단히</summary>

  <p>RNN의 activation 값을 Hidden State 라고도 합니다.     <br />
GRU에선 activation 값을 Cell State 라고 부릅니다.</p>

  <p>GRU는 Reset Gate, Update Gate 두 종류의 게이트를 가집니다.</p>

  <blockquote>
    <p><img src="assets/built/images/coursera_week1/coursera_week1_9_reset_gate.png" alt="" />
Reset Gate는 이전의 Cell State를 ‘얼마나 가져올지’ 를 결정해 줍니다.      <br />
<img src="assets/built/images/coursera_week1/coursera_week1_9_update_gate.png" alt="" />
Update Gate는 현재 들어온 정보(input값에 대한 정보)를 ‘얼마나 가져올지’ 를 결정해 줍니다.</p>
  </blockquote>

  <p>Reset, upadate 두 Gate의 결괏값을 이용해      <br />
‘이전 time step 까지의 정보’ 와 ‘새로운 input date의 정보’ 를 적절한 비율로 가진 다음 Cell State를 계산해 줍니다.</p>

  <p>그 결과 GRU는 긴 시퀀스 데이터의 경우에도 앞 쪽의 정보를 뒷 쪽에 적절히 가져갈 수 있게 됩니다.    <br />
(앞쪽의 정보를 필요한 만큼 뒷쪽까지 가져간다!)</p>

</details>

<h1 id="10long-short-term-memory-lstm">10.Long Short Term Memory (LSTM)</h1>
<p>이 강의에선 LSTM에 대해 설명합니다.   <br />
GRU와 아이디어 자체는 비슷하며, LSTM은 Cell State와 Hidden State를 둘 다 가진다는 큰 차이가 있습니다.    <br />
Cell State는 장기 상태(Long Term Memory)      <br />
Hidden State는 단기 상태(Short Term Memory) 를 저장/전달 합니다.      <br />
입력 Gate, 삭제 Gate, 출력 Gate 총 세 개의 Gate를 가집니다.</p>

<p>GRU에 보다 더 긴 시퀀스 데이터 처리를 잘 하긴 합니다만. GRU, LSTM 중 누가 더 좋은지는 Task 마다 다릅니다.</p>

<p>c.f.) 강의는 GRU가 먼저 이지만 LSTM의 구조를 간소화 한 모델이 GRU 입니다.(뉴욕대 ‘조경현’ 교수님 작품!!!)</p>

<details>
  <summary>자세히/간단히</summary>
  <blockquote>
    <p><img src="assets/built/images/coursera_week1/coursera_week1_10_input_gate.png" alt="" />
입력 게이트는 이전 Time Step의 Hidden State(단기 메모리)와 이번 Time Step의 input data의 연산으로     <br />
현재 상태를 얼마나 저장 할지를 정합니다.</p>
  </blockquote>

  <blockquote>
    <p><img src="assets/built/images/coursera_week1/coursera_week1_10_delete_gate.png" alt="" />
삭제 게이트는 이전 Time Step의 Hidden State(단기 메모리)와 이번 Time Step의 input data의 연산으로     <br />
이전 상태를 얼마나 삭제 할지를 정합니다.</p>
  </blockquote>

  <blockquote>
    <p><img src="assets/built/images/coursera_week1/coursera_week1_10_cell_state.png" alt="" />
입력&amp;삭제 게이트의 결과와 이전 Time Step의 Cell State(장기 메모리) 의 연산으로    <br />
이번 Time Step의 Cell State를 계산합니다.</p>
  </blockquote>

  <blockquote>
    <p><img src="assets/built/images/coursera_week1/coursera_week1_10_output_gate.png" alt="" />
출력 게이트는 Hidden State(단기 메모리)와 input data을 연산해 어떤 결과 O<sub>t</sub> 를 냅니다.     <br />
그 후, O<sub>t</sub> 와 이번 Time Step의 Cell State 를 연산해 이번 Time Step의 Hidden State를 계산합니다.</p>
  </blockquote>

  <p>첨부된 이미지들은 유원준 님의 저서에서 가져왔습니다.      <br />
<a href="https://wikidocs.net/22888">유원준님 저서 링크</a></p>

</details>

<h1 id="11bidirectional-rnn">11.Bidirectional RNN</h1>

<h1 id="12deep-rnns">12.Deep RNNs</h1>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to DL&NLP</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/built/images/author-logo.jpg" alt="dhsimpson" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/dhsimpson">DongHee Youn</a></h4>
                                
                                    <p>Read <a href="/author/dhsimpson">more posts</a> by this author.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/dhsimpson">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = 'https://dhsimpson.github.io/nlp_coursera_seq_week1_1';
                            this.page.identifier = '/nlp_coursera_seq_week1_1';
                            this.page.title = '자연어 처리 기본 - 콜세라 강의 1주차 1리뷰';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://dhsimpson-github-io.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/paperimpl_sample">
                <div class="post-card-image" style="background-image: url(/assets/built/images/background_paper_implement.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/paperimpl_sample">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Paperimplement</span>
                            
                        
                    

                    <h2 class="post-card-title">논문 구현 샘플</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/author-logo.jpg" alt="DongHee Youn" />
                        
                        <span class="post-card-author">
                            <a href="/author/dhsimpson/">DongHee Youn</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://dhsimpson.github.io/">
            
            <span>DL&NLP</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">자연어 처리 기본 - 콜세라 강의 1주차 1리뷰</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%EC%9E%90%EC%97%B0%EC%96%B4+%EC%B2%98%EB%A6%AC+%EA%B8%B0%EB%B3%B8+-+%EC%BD%9C%EC%84%B8%EB%9D%BC+%EA%B0%95%EC%9D%98+1%EC%A3%BC%EC%B0%A8+1%EB%A6%AC%EB%B7%B0&amp;url=https://dhsimpson.github.io/nlp_coursera_seq_week1_1"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://dhsimpson.github.io/nlp_coursera_seq_week1_1"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://dhsimpson.github.io/">DL&NLP</a> &copy; 2020</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to DL&NLP</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
